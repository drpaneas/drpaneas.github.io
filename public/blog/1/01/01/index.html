<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> &middot; Panos Georgiadis</title>

  
  <link rel="stylesheet" href="https://w3.suse.de/~pgeorgiadis/public/css/poole.css">
  
  
  
  

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link href="/favicon.png" rel="icon">

  
  
  

  <meta name="description" content="A personal blog about Linux and stuff">
  <meta name="keywords" content="panos georgiadis, panos, drpaneas, linux, programming, guitar, paok, opensuse, suse">
  
</head>
<body class="theme-base-08">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
        <img src="https://w3.suse.de/~pgeorgiadis/publicpanos.png" alt="panos" height="200" width="200" >
        <h1>Panos Georgiadis</h1>
      
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="https://w3.suse.de/~pgeorgiadis/public/">Blog</a></li>
      
      <li class="sidebar-nav-item"><a href="/~pgeorgiadis/public/about/">About Me</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      
      
      
      
      
    </ul>

   <p>Copyleft &copy; 2016 <a href="https://w3.suse.de/~pgeorgiadis/public/license">License</a></p>
  </div>
</div>


<div class="content container">
  <div class="post">
    <h1></h1>
    <span class="post-date">Jan 1, 0001 &middot; 7 minute read
    </span>
    <div class="document">


<p>+++                                                                                                      │k.qam.suse.de travis.qam.suse.de
date = &quot;2016-01-12&quot;                                                                                      │Packager       : <a class="reference external" href="mailto:fstrba&#64;suse.com">fstrba&#64;suse.com</a>
title = &quot;How to test with SLEnkins&quot;
description = &quot;Basic tutorial for SLEnkins&quot;
menu = &quot;How-To&quot;                                                                                          │Repository     : <a class="reference external" href="http://download.suse.de/ibs/SUSE:/Maintenance:/1316/">http://download.suse.de/ibs/SUSE:/Maintenance:/1316/</a>
+++</p>
<div class="section" id="how-to-test-with-slenkins">
<h1>How to test with SLEnkins</h1>
<div class="section" id="introduction">
<h2>Introduction</h2>
<div class="section" id="what-is-slenkins">
<h3>What is SLEnkins</h3>
<p>Generally, SLEnkins is a framework that attempts to make testing of SLE
software as simple as possible for you, while integrating with SUSE
existing tools (like OBS).</p>
</div>
<div class="section" id="why-we-should-use-it">
<h3>Why we should use it</h3>
<p>There is a number of available testsuites that can be found within SLEnkins.
Most of them, are related to networking tools and services, such as
<em>apache2</em>, <em>bind</em>, <em>krb</em>, <em>ntp</em>, <em>nfs</em>, <em>ldap</em>, <em>sssd</em>, <em>squid</em>, <em>vsftp</em>,
<em>ipv6, *openvpn</em>, <em>rpc</em>, <em>rsyslog</em>, <em>postgresql</em>, <em>dhcp</em>, etc ...
Using SLEnkins we can easily enrich our regression testing coverage by
expanding into these new testcases. The most important part is that
everything is done automatically, so we do not have to manually configure
any particular setup.</p>
</div>
<div class="section" id="limitations">
<h3>Limitations</h3>
<p>SLEnkins supports only x86_64 architectures so far.
However, SLEnkins developers have put multi-arch support as their next
priority.</p>
</div>
<div class="section" id="who-is-responsible-for-it">
<h3>Who is responsible for it?</h3>
<p>If you have any questions or problems related to SLEnkins, please feel free
to contact <a class="reference external" href="mailto:pgeorgiadis&#64;suse.de">Panos Georgiadis</a> or address them directly to the
guru of SLEnkins, called <a class="reference external" href="mailto:EBischoff&#64;suse.com">Eric Bischoff</a>. If you still cannot find any
of them online, the <strong>#slenkins</strong> IRC channel is always there. Last but not
least, there is also a <a class="reference external" href="http://slenkins.suse.de/doc/">documentation</a> page for SLEnkins, mainly targetted
for developers who want to write their own testcases.</p>
</div>
</div>
<div class="section" id="first-steps">
<h2>First steps</h2>
<div class="section" id="dashboard">
<h3>Dashboard</h3>
<p>There are two ways to run a SLEnkins, either <strong>locally</strong> or <strong>remotely</strong>.
The most easy and convinient way is to trigger the testsuite remotely
by using the SLEnkins <a class="reference external" href="https://slenkins.suse.de/jenkins/">dashboard</a>. This is the web interface for setting
up and running your tests. Note that the word <em>build</em> actually means test,
so <em>build46</em> is <em>test46</em>.</p>
<ul class="simple">
<li>Login: <a class="reference external" href="https://slenkins.suse.de/jenkins/">https://slenkins.suse.de/jenkins/</a><ul>
<li>username: your NIS username</li>
<li>password: your NIS password</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="cloud">
<h3>Cloud</h3>
<p>This is where you go when your testsuite is currently running and you want
to get access into the very machines that are used for testing. Apparently,
you can also simply ssh into these machines, but this is also another way
to have console access via your browser. Other remarkable things you can do
is monitoring the network topology that is being used for your testing
purposes.</p>
<ul class="simple">
<li>Login: <a class="reference external" href="http://slenkins-cloud.suse.de/project/instances/">http://slenkins-cloud.suse.de/project/instances/</a><ul>
<li>username: slenkins</li>
<li>password: opensuse</li>
</ul>
</li>
</ul>
<p>Before try running any tests, it is recommended to visit these two websites
and get yourself familiar with their interface. Once you feel more
comfortable, it is time to move on and fire up some testsuites.</p>
</div>
</div>
<div class="section" id="how-to-run-a-testsuite">
<h2>How to run a testsuite</h2>
<div class="section" id="what-testsuites-are-available">
<h3>What testsuites are available</h3>
<p>First off, we need to know if there is a testsuite available for the package
we want to test. Go to the <a class="reference external" href="https://slenkins.suse.de/jenkins/">dashboard</a> and click to the <a class="reference external" href="https://slenkins.suse.de/jenkins/view/Test%20suites/">Test suites</a> tab.
There you will see the list of <strong>all</strong> currently available testsuites
unless someone forgot to reference them there. There is also another way
where you can group all the available testsuites sorted by product. If you
prefer that way, please check to the <a class="reference external" href="https://slenkins.suse.de/jenkins/view/Collections/">Collections</a> tab.</p>
</div>
<div class="section" id="what-is-the-status-of-the-testsuite">
<h3>What is the status of the testsuite</h3>
<p>Having all of these testsuites available for testing, that does not mean
that the state of all of them is well-maintained, such as some of them
might be problematic and prone to fail. To have an idea of what result
you should expect before running it, the SLEnkins guys are using
weather-forecast markings to indicate the overall status of the specific
test. Although it is pretty obvious to figure out what's going on just by
looking at them, you can also simply hover your mouse cursor above the
<strong>S</strong>-tatus and <strong>W</strong>-eather icons to read the full description.</p>
</div>
<div class="section" id="prerequisites">
<h3>Prerequisites</h3>
<p>What SLEnkins needs to know from QAM, is the <strong>URI</strong> of the repositories
where it can find the maint-packages we want to test. Also, we need the
<strong>ID</strong> of the release candidate in order to name our testsuite
accordingly. These information are available to all QAM engineers and you
should not face any problem finding those.</p>
<p>What a QAM engineer needs to know from SLEnkins, is the <strong>node file</strong> of
the testsuite he is going to merge into QAM.
As a rule of thumb, it is always good to check if other QAM engineers have
already merged testsuites for QAM, so in that case we could save time and
copy them, instead of creating a new template from scratch. The QAM
testsuites can be found at the <a class="reference external" href="https://slenkins.suse.de/jenkins/view/QA%20Maintenance/">QA Maintenance tab</a>. The node entry can be
found by looking into older results from <a class="reference external" href="https://slenkins.suse.de/jenkins/view/Test%20suites/">Test suites</a> using
the <strong>Console Ouput</strong> and searching for <strong>Parsing nodes file</strong> section.
Finally, you also need to be aware of the <a class="reference external" href="http://slenkins.suse.de/images/">SLEnkins images</a> that are going
to be provided in order to create the VMs for specific products.</p>
</div>
<div class="section" id="create-a-new-testsuite-for-qam">
<h3>Create a new testsuite for QAM</h3>
<p>Since SLEnkins is new to QAM, this is what we need to do first. As soon as
we merge all the available <a class="reference external" href="https://slenkins.suse.de/jenkins/view/Test%20suites/">Test suites</a> into <a class="reference external" href="https://slenkins.suse.de/jenkins/view/QA%20Maintenance/">QA Maintenance tab</a> then
there will no reason for it, since we will just go with
<em>copy from existing item</em>. But as for now, there is much work to yet to be
done, so feel free to create your new templates for QAM if nobody else has
done it for you already.  For example let see a real work scenario:</p>
<p>The update that I am going to test (only for x86_64) is related to <em>squid</em>:</p>
<pre class="literal-block">
ReviewRequestID  : SUSE:Maintenance:1316:87836
SRCRPMs          : squid
Products         : SERVER 12 (x86_64),SERVER 12-SP1 (x86_64)
</pre>
<!--  -->
<p>and here is what SLEnkins would like to know from this update:</p>
<pre class="literal-block">
ID: 1316
SLE12 SP0 repo: http://download.suse.de/ibs/SUSE:/Maintenance:/1316/SUSE_Updates_SLE-SERVER_12_x86_64/SUSE:Maintenance:1316.repo
SLE12 SP1 repo: http://download.suse.de/ibs/SUSE:/Maintenance:/1316/SUSE_Updates_SLE-SERVER_12-SP1_x86_64/SUSE:Maintenance:1316.repo
</pre>
<!--  -->
<p>Now let us create a <em>squid</em> testsuite for 1316 (ID) maintenance
release candidate and thus name it accordinly.</p>
<ol class="arabic simple">
<li>Go to <a class="reference external" href="https://slenkins.suse.de/jenkins/">dashboard</a> and login.</li>
<li>Go to <a class="reference external" href="https://slenkins.suse.de/jenkins/view/QA%20Maintenance/">QA Maintenance tab</a></li>
<li>From the top left menu, click <a class="reference external" href="https://slenkins.suse.de/jenkins/view/QA%20Maintenance/newJob">New Item</a>.</li>
<li>Item Name: <cite>qam-squid-1316</cite> (in general <cite>qam-pkg-ID</cite>)</li>
<li>Select <strong>Freestyle project</strong>.</li>
<li>Populate the description using <cite>&lt;pre&gt;...&lt;/pre&gt;</cite> HTML tags, <em>e.g.</em>:</li>
</ol>
<blockquote>
<pre class="literal-block">
&lt;pre&gt;
ReviewRequestID  : SUSE:Maintenance:1316:87836
SRCRPMs          : squid
Rating           : moderate
Products         : SERVER 12 (x86_64, s390x, ppc64le),SERVER 12-SP1 (x86_64, s390x, ppc64le)
Incident Priority: 100
Assigned Roles   :

- Note: Only x86_64 architecture
&lt;/pre&gt;
</pre>
<!--  -->
</blockquote>
<ol class="arabic simple" start="7">
<li>Tick the checkbox <strong>Discard Old Build</strong>.This will prompt a couple of new
settings, such as:<ul>
<li>Days to keep build: <cite>8</cite></li>
<li>Max # of build to keep: <cite>5</cite></li>
</ul>
</li>
<li>Scroll down to <strong>Build</strong> and click <strong>Add build step</strong>. From the drop
down menu, select <strong>Execute shell</strong>. Here we are going to modify some
parameteres and tell SLEnkins to use our maintenance squid package. To do
that, we have to first familiarize ourselves with <a class="reference external" href="https://slenkins.suse.de/jenkins/view/Test%20suites/job/suite-squid/lastCompletedBuild/console">squid nodefile</a> from
an old testreport. Here it is:</li>
</ol>
<blockquote>
<pre class="literal-block">
Parsing nodes file
=======================================================
node     server
repo     ${CHANNEL_SLENKINS_SERVER}
install  apache2
install  tests-squid-tests-server
node     proxy
repo     ${CHANNEL_SLENKINS_PROXY}
install  squid
install  tests-squid-tests-proxy
node     client
repo     ${CHANNEL_SLENKINS_CLIENT}
install  wget
install  tests-squid-tests-client
=======================================================
</pre>
<!--  -->
<p>What this means is that squid testsuite is going to create 3 VMs:</p>
<ul class="simple">
<li>server (install apache2)</li>
<li>proxy (install squid)</li>
<li>client (install wget)</li>
</ul>
<p>So this means we need to modify the <cite>${CHANNEL_SLENKINS_PROXY}</cite> variable
to look into our QAM repos, so to install the squid from our repos.
Furthermore, we need to provide the image files for these products. These
can be found at <a class="reference external" href="http://slenkins.suse.de/images/">SLEnkins images</a> omitting the <cite>.qcow2</cite> suffix. Last
but not least, you need to add the information related to where to save
the log files. Given that we are going to test two products (SLE12 and
SLE12 SP1) we need to specify different directories to avoid overwrite
problems. The variable names can be found by looking the
<a class="reference external" href="https://slenkins.suse.de/jenkins/view/Test%20suites/job/suite-squid/configure">squid configuration</a> at the <cite>Execute shell</cite> section.
Once you have gathered all the available information, here is how you
should populate this section:</p>
<pre class="literal-block">
echo &quot;Doing for SLE 12&quot;
qam_1316='http://download.suse.de/ibs/SUSE:/Maintenance:/1316/SUSE_Updates_SLE-SERVER_12_x86_64/SUSE:Maintenance:1316.repo'

export IMAGE_NAME_SERVER=SLE_12-x86_64-default
export IMAGE_NAME_PROXY=SLE_12-x86_64-default
export IMAGE_NAME_CLIENT=SLE_12-x86_64-default

export REPO_PROXY=&quot;\${CHANNEL_SLENKINS_PROXY} ${qam_1316}&quot;

export PROJECT_NAME=tests-squid
export CONTROL_PKG=tests-control

/usr/lib/slenkins/cloud/run-tests-in-cloud.sh

mv junit-results.xml junit-results-sle12.xml
</pre>
</blockquote>
<!--  -->
<blockquote>
<p>Next we are going to copy and paste the same thing, but modify the repo URI,
the images and also the logfile. So, click again to  <strong>Add build step</strong>.
From the drop down menu, select <strong>Execute shell</strong>. Here is the information
for SLE12 SP1:</p>
<pre class="literal-block">
echo &quot;Doing for SLE 12 SP1&quot;
qam_1316='http://download.suse.de/ibs/SUSE:/Maintenance:/1316/SUSE_Updates_SLE-SERVER_12-SP1_x86_64/SUSE:Maintenance:1316.repo'

export IMAGE_NAME_SERVER=SLE_12_SP1-x86_64-default
export IMAGE_NAME_PROXY=SLE_12_SP1-x86_64-default
export IMAGE_NAME_CLIENT=SLE_12_SP1-x86_64-default

export REPO_PROXY=&quot;\${CHANNEL_SLENKINS_PROXY} ${qam_1316}&quot;

export PROJECT_NAME=tests-squid
export CONTROL_PKG=tests-control

/usr/lib/slenkins/cloud/run-tests-in-cloud.sh

mv junit-results.xml junit-results-sle12-sp1.xml
</pre>
</blockquote>
<!--  -->
<ol class="arabic simple" start="9">
<li>Click <strong>Save</strong> and <strong>Build Now</strong> which means <em>Test Now</em>.</li>
</ol>
</div>
<div class="section" id="where-are-the-results">
<h3>Where are the results</h3>
<p>While the test is running, you are able to monitor the output on-the-fly
using the <strong>Console Output</strong>. If everythind work as expected, you should
see somthing like this:</p>
<pre class="literal-block">
Recording test results
Finished: SUCCESS
</pre>
<!--  -->
<p>Otherwise, if you want to login into the
VMs you can go to <a class="reference external" href="http://slenkins-cloud.suse.de/">cloud</a> &gt; Project &gt; Compute &gt; Instance and select the VM.
From there, you have terminal access using the following credentials:</p>
<ul class="simple">
<li>username: root or testuser</li>
<li>password: opensuse</li>
</ul>
</div>
</div>
</div>
</div>
  </div>
  
</div>




<script src="https://w3.suse.de/~pgeorgiadis/public/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

</body>
</html>